#---------------------------------------------------------------------------
# Copyright 2012 The Open Source Electronic Health Record Agent
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#---------------------------------------------------------------------------

from OSEHRAHelper import PROMPT

def StartTaskMan(VistA):
  # VistA.wait(PROMPT)
  # VistA.write('K')
  VistA.wait(PROMPT)
  VistA.write("S DUZ=1 D ^XUP") # program menu
  VistA.wait("Select OPTION NAME:")
  VistA.write("EVE") # Systems Manager Menu
  VistA.wait("CHOOSE 1-\d+:")
  VistA.write("1") # Systems Manager Menu
  VistA.wait("Select Systems Manager Menu Option:")
  VistA.write("Taskman Management")
  VistA.wait("Select Taskman Management Option:")
  VistA.write("Taskman Management Utilities")
  VistA.wait("Select Taskman Management Utilities Option:")
  VistA.write("Restart Task Manager")
  index = VistA.multiwait(["ARE YOU SURE YOU WANT TO RESTART ANOTHER TASKMAN\?",
                           "ARE YOU SURE YOU WANT TO RESTART TASKMAN\?"])
  if index == 0:
    VistA.write("NO")
  elif index == 1:
    VistA.write("YES")
    VistA.wait("Restarting...TaskMan restarted\!")
  VistA.wait("Select Taskman Management Utilities Option:")
  VistA.write("")
  VistA.wait("Select Taskman Management Option:")
  VistA.write("")
  VistA.wait("Select Systems Manager Menu Option:")
  VistA.write("") # Systems Manager Menu
  VistA.wait("Do you really want to halt\?")
  VistA.write("YES") # Systems Manager Menu
  VistA.wait(PROMPT)
  VistA.write("")
