#---------------------------------------------------------------------------
# Copyright 2012 The Open Source Electronic Health Record Agent
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#---------------------------------------------------------------------------

<<<<<<< HEAD
def AddOneClinic(VistA,clinicname,abbreviation,phonenumber,provider,stopcode,appointmentlength):
  VistA.write('Set up a Clinic')
  VistA.wait('CLINIC NAME')
  VistA.write(clinicname + '\rY')
  VistA.wait('NAME')
  VistA.write('')
  VistA.wait('ABBREVIATION')
  VistA.write(abbreviation)
  VistA.wait('CLINIC MEETS')
  VistA.write('Y')
  VistA.wait('SERVICE')
  VistA.write('M')
  VistA.wait('NON-COUNT CLINIC')
  VistA.write('N')
  VistA.wait('STOP CODE NUMBER')
  VistA.write(stopcode)
  VistA.wait('DEFAULT APPOINTMENT TYPE')
  VistA.write('')
  VistA.wait('ADMINISTER INPATIENT MEDS')
  VistA.write('')  
  VistA.wait('TELEPHONE')
  VistA.write(phonenumber)
  VistA.wait('REQUIRE X-RAY FILMS')
  VistA.write('')
  VistA.wait('REQUIRE ACTION PROFILES')
  VistA.write('Y')
  VistA.wait('NO SHOW LETTER')
  VistA.write('')
  VistA.wait('PRE-APPOINTMENT LETTER')
  VistA.write('')
  VistA.wait('CLINIC CANCELLATION LETTER')
  VistA.write('')
  VistA.wait('APPT. CANCELLATION LETTER')
  VistA.write('')
  VistA.wait('ASK FOR CHECK IN/OUT TIME')
  VistA.write('')
  VistA.wait('Select PROVIDER')
  VistA.write(provider + '\rY')
  VistA.wait('DEFAULT PROVIDER')
  VistA.write('')
  VistA.wait('Select PROVIDER')
  VistA.write('')
  VistA.wait('DEFAULT TO PC PRACTITIONER')
  VistA.write('')
  VistA.wait('Select DIAGNOSIS')
  VistA.write('')
  VistA.wait('WORKLOAD VALIDATION AT CHK OUT')
  VistA.write('Y')
  VistA.wait('ALLOWABLE CONSECUTIVE NO-SHOWS')
  VistA.write('1')
  VistA.wait('FUTURE BOOKING')
  VistA.write('365')
  VistA.wait('HOUR CLINIC DISPLAY BEGINS')
  VistA.write('8')
  VistA.wait('START TIME FOR AUTO REBOOK')
  VistA.write('8')
  VistA.wait('DAYS FOR AUTO-REBOOK')
  VistA.write('1')
  VistA.wait('SCHEDULE ON HOLIDAYS')
  VistA.write('')
  VistA.wait('CREDIT STOP CODE')
  VistA.write('')
  VistA.wait('PROHIBIT ACCESS TO CLINIC')
  VistA.write('')
  VistA.wait('PHYSICAL LOCATION')
  VistA.write('')
  VistA.wait('PRINCIPAL CLINIC')
  VistA.write('')
  VistA.wait('OVERBOOKS/DAY MAXIMUM')
  VistA.write('1')
  VistA.wait('Select SPECIAL INSTRUCTIONS')
  VistA.write('')
  VistA.wait('LENGTH OF APP\'T')
  VistA.write(appointmentlength)
  VistA.wait('VARIABLE')
  VistA.write('Yes')
  VistA.wait('DISPLAY INCREMENTS PER HOUR')
  slots = 60/int(appointmentlength)
  VistA.write(str(slots))
  dates = ['JUL 2,2012','JUL 3,2012','JUL 4,2012','JUL 5,2012','JUL 6,2012']
  for date in dates:
    VistA.wait('AVAILABILITY DATE')
    VistA.write(date)
    VistA.wait('TIME')
    VistA.write('0800-1200\r2')
    VistA.wait('TIME')
    VistA.write('1230-1500\r2')
    VistA.wait('TIME')
    VistA.write('')
    VistA.wait('PATTERN OK')
    VistA.write('Yes')
  VistA.wait('AVAILABILITY DATE')
  VistA.write('\r')
=======
# Add the VHC clinic via the XUP menu to allow scheduling
VistA.wait('Menu Option:')
VistA.write('Core Applications')
VistA.wait('Core Applications Option')
VistA.write('Scheduling Manager')
VistA.wait('Menu Option')
VistA.write('Supervisor Menu')
VistA.wait('Supervisor Menu Option')
VistA.write('Set up a Clinic')
VistA.wait('Select CLINIC NAME')
VistA.write('VISTA HEALTH CARE')
VistA.wait('Are you adding')
VistA.write('Y')
VistA.wait('NAME')
VistA.write('')
VistA.wait('ABBREVIATION')
VistA.write('VHC')
VistA.wait('CLINIC MEETS')
VistA.write('Y')
VistA.wait('SERVICE')
VistA.write('M')
VistA.wait('NON-COUNT CLINIC')
VistA.write('N')
VistA.wait('STOP CODE NUMBER')
VistA.write('301\r\r')
VistA.wait('TELEPHONE')
VistA.write('555-555-1414\r\r\r\r\r\r\r\r\r\r\r')
VistA.wait('ALLOWABLE CONSECUTIVE NO-SHOWS')
VistA.write('0')
VistA.wait('FUTURE BOOKING')
VistA.write('90')
VistA.wait('HOUR CLINIC DISPLAY BEGINS')
VistA.write('8\r')
VistA.wait('AUTO-REBOOK')
VistA.write('90\r\r\r\r\r')
VistA.wait('MAXIMUM')
VistA.write('0\r')
VistA.wait('LENGTH OF APP')
VistA.write('30')
VistA.wait('VARIABLE')
VistA.write('Yes')
VistA.wait('DISPLAY INCREMENTS PER HOUR')
VistA.write('2')
dates = ['JUL 2,2012','JUL 3,2012','JUL 4,2012','JUL 5,2012','JUL 6,2012']
for date in dates:
  VistA.wait('AVAILABILITY DATE')
  VistA.write(date)
  VistA.wait('TIME')
  VistA.write('0800-1200\r4')
  VistA.wait('TIME')
  VistA.write('1230-1500\r4')
  VistA.wait('TIME')
  VistA.write('')
  VistA.wait('PATTERN OK')
  VistA.write('Yes')
VistA.wait('AVAILABILITY DATE')
VistA.write('\r\r\r\r')

# Add the VHC clinic via the XUP menu to allow scheduling
VistA.wait('Menu Option:')
VistA.write('Core Applications')
VistA.wait('Core Applications Option')
VistA.write('Scheduling Manager')
VistA.wait('Menu Option')
VistA.write('Supervisor Menu')
VistA.wait('Supervisor Menu Option')
VistA.write('Set up a Clinic')
VistA.wait('Select CLINIC NAME')
VistA.write('VISTA MEDICAL CENTER')
VistA.wait('Are you adding')
VistA.write('Y')
VistA.wait('NAME')
VistA.write('')
VistA.wait('ABBREVIATION')
VistA.write('VMC')
VistA.wait('CLINIC MEETS')
VistA.write('Y')
VistA.wait('SERVICE')
VistA.write('M')
VistA.wait('NON-COUNT CLINIC')
VistA.write('N')
VistA.wait('STOP CODE NUMBER')
VistA.write('301\r\r')
VistA.wait('TELEPHONE')
VistA.write('555-555-3636\r\r\r\r\r\r\r\r\r\r\r')
VistA.wait('ALLOWABLE CONSECUTIVE NO-SHOWS')
VistA.write('0')
VistA.wait('FUTURE BOOKING')
VistA.write('90')
VistA.wait('HOUR CLINIC DISPLAY BEGINS')
VistA.write('8\r')
VistA.wait('AUTO-REBOOK')
VistA.write('90\r\r\r\r\r')
VistA.wait('MAXIMUM')
VistA.write('0\r')
VistA.wait('LENGTH OF APP')
VistA.write('30')
VistA.wait('VARIABLE')
VistA.write('Yes')
VistA.wait('DISPLAY INCREMENTS PER HOUR')
VistA.write('2')
dates = ['JUL 2,2012','JUL 3,2012','JUL 4,2012','JUL 5,2012','JUL 6,2012']
for date in dates:
  VistA.wait('AVAILABILITY DATE')
  VistA.write(date)
  VistA.wait('TIME')
  VistA.write('0800-1200\r4')
  VistA.wait('TIME')
  VistA.write('1230-1500\r4')
  VistA.wait('TIME')
  VistA.write('')
  VistA.wait('PATTERN OK')
  VistA.write('Yes')
VistA.wait('AVAILABILITY DATE')
VistA.write('\r\r\r\r\r')
VistA.wait('Do you really want to halt?')
VistA.write('Y')

>>>>>>> a4d2881514ee94af29c0e3055395248897f97618
